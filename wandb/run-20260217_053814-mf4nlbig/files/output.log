Class weights: [0.8669081926345825, 1.0164259672164917, 1.1592377424240112]
Fold 1 Epoch [  1/100] Train Loss: 1.2745  Train Acc: 34.86%  |  Val Loss: 1.1385  Val BAcc: 33.33%  Val mAUC: 0.5779  LR: 0.001000  Time: 253.8s
  -> New best balanced accuracy: 33.33%
Fold 1 Epoch [  2/100] Train Loss: 1.1594  Train Acc: 33.80%  |  Val Loss: 1.1121  Val BAcc: 33.33%  Val mAUC: 0.6078  LR: 0.001000  Time: 252.6s
Fold 1 Epoch [  3/100] Train Loss: 1.1333  Train Acc: 34.19%  |  Val Loss: 1.1061  Val BAcc: 33.53%  Val mAUC: 0.6042  LR: 0.001000  Time: 252.7s
  -> New best balanced accuracy: 33.53%
Fold 1 Epoch [  4/100] Train Loss: 1.1150  Train Acc: 34.05%  |  Val Loss: 1.0917  Val BAcc: 43.33%  Val mAUC: 0.5958  LR: 0.001000  Time: 252.8s
  -> New best balanced accuracy: 43.33%
Fold 1 Epoch [  5/100] Train Loss: 1.1080  Train Acc: 34.08%  |  Val Loss: 1.0991  Val BAcc: 33.28%  Val mAUC: 0.6583  LR: 0.001000  Time: 252.7s
Fold 1 Epoch [  6/100] Train Loss: 1.1064  Train Acc: 36.44%  |  Val Loss: 1.0430  Val BAcc: 47.06%  Val mAUC: 0.6673  LR: 0.001000  Time: 254.7s
  -> New best balanced accuracy: 47.06%
Fold 1 Epoch [  7/100] Train Loss: 1.0862  Train Acc: 38.98%  |  Val Loss: 1.0022  Val BAcc: 50.96%  Val mAUC: 0.6913  LR: 0.001000  Time: 251.7s
  -> New best balanced accuracy: 50.96%
Fold 1 Epoch [  8/100] Train Loss: 1.0605  Train Acc: 43.66%  |  Val Loss: 0.9881  Val BAcc: 47.37%  Val mAUC: 0.7101  LR: 0.001000  Time: 254.4s
Fold 1 Epoch [  9/100] Train Loss: 0.9936  Train Acc: 49.23%  |  Val Loss: 0.9144  Val BAcc: 54.49%  Val mAUC: 0.7493  LR: 0.001000  Time: 251.1s
  -> New best balanced accuracy: 54.49%
Fold 1 Epoch [ 10/100] Train Loss: 0.9317  Train Acc: 56.76%  |  Val Loss: 0.8248  Val BAcc: 62.93%  Val mAUC: 0.7966  LR: 0.001000  Time: 253.2s
  -> New best balanced accuracy: 62.93%
Fold 1 Epoch [ 11/100] Train Loss: 0.8889  Train Acc: 59.77%  |  Val Loss: 0.7547  Val BAcc: 65.41%  Val mAUC: 0.8426  LR: 0.001000  Time: 253.5s
  -> New best balanced accuracy: 65.41%
Fold 1 Epoch [ 12/100] Train Loss: 0.8259  Train Acc: 66.93%  |  Val Loss: 0.8656  Val BAcc: 64.36%  Val mAUC: 0.8468  LR: 0.001000  Time: 251.8s
Fold 1 Epoch [ 13/100] Train Loss: 0.7916  Train Acc: 70.30%  |  Val Loss: 0.7270  Val BAcc: 70.92%  Val mAUC: 0.8823  LR: 0.001000  Time: 250.4s
  -> New best balanced accuracy: 70.92%
Fold 1 Epoch [ 14/100] Train Loss: 0.7037  Train Acc: 76.73%  |  Val Loss: 0.7922  Val BAcc: 74.45%  Val mAUC: 0.9043  LR: 0.001000  Time: 252.4s
  -> New best balanced accuracy: 74.45%
Fold 1 Epoch [ 15/100] Train Loss: 0.6831  Train Acc: 79.07%  |  Val Loss: 0.7716  Val BAcc: 78.05%  Val mAUC: 0.9154  LR: 0.001000  Time: 264.4s
  -> New best balanced accuracy: 78.05%
Fold 1 Epoch [ 16/100] Train Loss: 0.5963  Train Acc: 83.00%  |  Val Loss: 1.3103  Val BAcc: 70.93%  Val mAUC: 0.9068  LR: 0.001000  Time: 268.5s
Fold 1 Epoch [ 17/100] Train Loss: 0.5057  Train Acc: 86.99%  |  Val Loss: 1.0408  Val BAcc: 79.46%  Val mAUC: 0.9240  LR: 0.001000  Time: 267.1s
  -> New best balanced accuracy: 79.46%
Fold 1 Epoch [ 18/100] Train Loss: 0.4371  Train Acc: 88.85%  |  Val Loss: 1.0732  Val BAcc: 81.20%  Val mAUC: 0.9325  LR: 0.001000  Time: 265.8s
  -> New best balanced accuracy: 81.20%
Fold 1 Epoch [ 19/100] Train Loss: 0.4193  Train Acc: 90.44%  |  Val Loss: 1.2458  Val BAcc: 78.89%  Val mAUC: 0.9314  LR: 0.001000  Time: 263.9s
Fold 1 Epoch [ 20/100] Train Loss: 0.3183  Train Acc: 92.70%  |  Val Loss: 1.1711  Val BAcc: 82.45%  Val mAUC: 0.9385  LR: 0.001000  Time: 266.2s
  -> New best balanced accuracy: 82.45%
Fold 1 Epoch [ 21/100] Train Loss: 0.3369  Train Acc: 93.01%  |  Val Loss: 1.3355  Val BAcc: 80.94%  Val mAUC: 0.9364  LR: 0.001000  Time: 259.3s
Fold 1 Epoch [ 22/100] Train Loss: 0.2555  Train Acc: 94.46%  |  Val Loss: 1.3263  Val BAcc: 83.17%  Val mAUC: 0.9397  LR: 0.001000  Time: 263.4s
  -> New best balanced accuracy: 83.17%
Fold 1 Epoch [ 23/100] Train Loss: 0.2646  Train Acc: 94.37%  |  Val Loss: 1.4372  Val BAcc: 83.50%  Val mAUC: 0.9367  LR: 0.001000  Time: 266.4s
  -> New best balanced accuracy: 83.50%
Fold 1 Epoch [ 24/100] Train Loss: 0.2564  Train Acc: 94.87%  |  Val Loss: 1.3965  Val BAcc: 84.33%  Val mAUC: 0.9450  LR: 0.001000  Time: 264.1s
  -> New best balanced accuracy: 84.33%
Fold 1 Epoch [ 25/100] Train Loss: 0.1557  Train Acc: 96.52%  |  Val Loss: 1.4911  Val BAcc: 82.21%  Val mAUC: 0.9455  LR: 0.001000  Time: 264.0s
Fold 1 Epoch [ 26/100] Train Loss: 0.1629  Train Acc: 96.68%  |  Val Loss: 1.7124  Val BAcc: 82.31%  Val mAUC: 0.9460  LR: 0.001000  Time: 263.0s
Fold 1 Epoch [ 27/100] Train Loss: 0.1586  Train Acc: 96.85%  |  Val Loss: 1.5773  Val BAcc: 82.19%  Val mAUC: 0.9454  LR: 0.001000  Time: 266.7s
Fold 1 Epoch [ 28/100] Train Loss: 0.1269  Train Acc: 97.19%  |  Val Loss: 1.7811  Val BAcc: 81.85%  Val mAUC: 0.9460  LR: 0.001000  Time: 263.8s
Fold 1 Epoch [ 29/100] Train Loss: 0.1212  Train Acc: 97.21%  |  Val Loss: 1.4742  Val BAcc: 83.98%  Val mAUC: 0.9486  LR: 0.001000  Time: 263.7s
Fold 1 Epoch [ 30/100] Train Loss: 0.1111  Train Acc: 97.66%  |  Val Loss: 1.5928  Val BAcc: 83.70%  Val mAUC: 0.9499  LR: 0.000100  Time: 263.9s
Fold 1 Epoch [ 31/100] Train Loss: 0.0481  Train Acc: 98.89%  |  Val Loss: 1.7223  Val BAcc: 84.53%  Val mAUC: 0.9501  LR: 0.000100  Time: 264.4s
  -> New best balanced accuracy: 84.53%
Fold 1 Epoch [ 32/100] Train Loss: 0.0477  Train Acc: 98.94%  |  Val Loss: 1.7400  Val BAcc: 84.48%  Val mAUC: 0.9502  LR: 0.000100  Time: 268.0s
Fold 1 Epoch [ 33/100] Train Loss: 0.0413  Train Acc: 98.97%  |  Val Loss: 1.6571  Val BAcc: 84.50%  Val mAUC: 0.9514  LR: 0.000100  Time: 266.7s

Early stopping at epoch 33 (patience=20)

============================================================
  Fold 1 Best Val Results
============================================================
  Loss:              1.7223
  Accuracy:          85.30%
  Balanced Accuracy: 84.53%
  Micro AUC:         0.9537
  Macro AUC:         0.9501
  AUC (CN):         0.9847
  AUC (MCI):         0.9121
  AUC (AD):         0.9534

  Confusion Matrix:
               CN    MCI     AD
        CN    321     23      1
       MCI     17    245     32
        AD      1     58    200

  Per-class metrics:
    CN: Sensitivity=0.9304  Specificity=0.9675
    MCI: Sensitivity=0.8333  Specificity=0.8659
    AD: Sensitivity=0.7722  Specificity=0.9484
============================================================

  Confusion matrix saved to ./checkpoints/divnet/figures/fold_1_confusion_matrix.png
