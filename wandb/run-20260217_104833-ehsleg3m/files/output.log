Class weights: [0.8671497702598572, 1.0167090892791748, 1.1584382057189941]
Fold 3 Epoch [  1/100] Train Loss: 1.2820  Train Acc: 34.26%  |  Val Loss: 1.1023  Val BAcc: 33.33%  Val mAUC: 0.5876  LR: 0.001000  Time: 266.3s
  -> New best balanced accuracy: 33.33%
Fold 3 Epoch [  2/100] Train Loss: 1.1579  Train Acc: 34.62%  |  Val Loss: 1.0904  Val BAcc: 46.48%  Val mAUC: 0.6341  LR: 0.001000  Time: 265.5s
  -> New best balanced accuracy: 46.48%
Fold 3 Epoch [  3/100] Train Loss: 1.1297  Train Acc: 33.96%  |  Val Loss: 1.0887  Val BAcc: 38.26%  Val mAUC: 0.6443  LR: 0.001000  Time: 265.5s
Fold 3 Epoch [  4/100] Train Loss: 1.1208  Train Acc: 33.76%  |  Val Loss: 1.1436  Val BAcc: 33.33%  Val mAUC: 0.6138  LR: 0.001000  Time: 266.8s
Fold 3 Epoch [  5/100] Train Loss: 1.1099  Train Acc: 35.52%  |  Val Loss: 1.0849  Val BAcc: 39.47%  Val mAUC: 0.6576  LR: 0.001000  Time: 267.3s
Fold 3 Epoch [  6/100] Train Loss: 1.0829  Train Acc: 41.50%  |  Val Loss: 1.0460  Val BAcc: 46.37%  Val mAUC: 0.6647  LR: 0.001000  Time: 258.6s
Fold 3 Epoch [  7/100] Train Loss: 1.0708  Train Acc: 44.04%  |  Val Loss: 0.9807  Val BAcc: 46.38%  Val mAUC: 0.6869  LR: 0.001000  Time: 251.6s
Fold 3 Epoch [  8/100] Train Loss: 1.0210  Train Acc: 49.89%  |  Val Loss: 0.9939  Val BAcc: 49.84%  Val mAUC: 0.7079  LR: 0.001000  Time: 260.9s
  -> New best balanced accuracy: 49.84%
Fold 3 Epoch [  9/100] Train Loss: 0.9732  Train Acc: 52.37%  |  Val Loss: 0.9008  Val BAcc: 56.13%  Val mAUC: 0.7598  LR: 0.001000  Time: 261.5s
  -> New best balanced accuracy: 56.13%
Fold 3 Epoch [ 10/100] Train Loss: 0.8875  Train Acc: 59.19%  |  Val Loss: 0.8597  Val BAcc: 59.54%  Val mAUC: 0.8032  LR: 0.001000  Time: 261.3s
  -> New best balanced accuracy: 59.54%
Fold 3 Epoch [ 11/100] Train Loss: 0.8568  Train Acc: 62.70%  |  Val Loss: 0.8129  Val BAcc: 64.30%  Val mAUC: 0.8307  LR: 0.001000  Time: 265.3s
  -> New best balanced accuracy: 64.30%
Fold 3 Epoch [ 12/100] Train Loss: 0.7872  Train Acc: 67.63%  |  Val Loss: 0.8164  Val BAcc: 68.90%  Val mAUC: 0.8430  LR: 0.001000  Time: 265.4s
  -> New best balanced accuracy: 68.90%
Fold 3 Epoch [ 13/100] Train Loss: 0.7724  Train Acc: 72.06%  |  Val Loss: 1.0769  Val BAcc: 66.66%  Val mAUC: 0.8730  LR: 0.001000  Time: 263.8s
Fold 3 Epoch [ 14/100] Train Loss: 0.7230  Train Acc: 75.21%  |  Val Loss: 0.9452  Val BAcc: 72.52%  Val mAUC: 0.8884  LR: 0.001000  Time: 261.3s
  -> New best balanced accuracy: 72.52%
Fold 3 Epoch [ 15/100] Train Loss: 0.6677  Train Acc: 80.33%  |  Val Loss: 0.8389  Val BAcc: 77.53%  Val mAUC: 0.9133  LR: 0.001000  Time: 262.6s
  -> New best balanced accuracy: 77.53%
Fold 3 Epoch [ 16/100] Train Loss: 0.5314  Train Acc: 84.96%  |  Val Loss: 0.8999  Val BAcc: 80.89%  Val mAUC: 0.9259  LR: 0.001000  Time: 263.9s
  -> New best balanced accuracy: 80.89%
Fold 3 Epoch [ 17/100] Train Loss: 0.4896  Train Acc: 86.85%  |  Val Loss: 1.2146  Val BAcc: 76.62%  Val mAUC: 0.9193  LR: 0.001000  Time: 265.6s
Fold 3 Epoch [ 18/100] Train Loss: 0.4123  Train Acc: 89.42%  |  Val Loss: 1.0391  Val BAcc: 79.59%  Val mAUC: 0.9390  LR: 0.001000  Time: 263.3s
Fold 3 Epoch [ 19/100] Train Loss: 0.3980  Train Acc: 91.14%  |  Val Loss: 1.1386  Val BAcc: 81.39%  Val mAUC: 0.9401  LR: 0.001000  Time: 265.2s
  -> New best balanced accuracy: 81.39%
Fold 3 Epoch [ 20/100] Train Loss: 0.3611  Train Acc: 91.84%  |  Val Loss: 1.3425  Val BAcc: 77.61%  Val mAUC: 0.9382  LR: 0.001000  Time: 263.3s
Fold 3 Epoch [ 21/100] Train Loss: 0.3329  Train Acc: 93.15%  |  Val Loss: 1.2241  Val BAcc: 82.69%  Val mAUC: 0.9476  LR: 0.001000  Time: 266.7s
  -> New best balanced accuracy: 82.69%
Fold 3 Epoch [ 22/100] Train Loss: 0.2688  Train Acc: 93.62%  |  Val Loss: 1.0507  Val BAcc: 84.11%  Val mAUC: 0.9518  LR: 0.001000  Time: 266.1s
  -> New best balanced accuracy: 84.11%
Fold 3 Epoch [ 23/100] Train Loss: 0.2409  Train Acc: 95.04%  |  Val Loss: 1.1033  Val BAcc: 85.02%  Val mAUC: 0.9565  LR: 0.001000  Time: 268.2s
  -> New best balanced accuracy: 85.02%
Fold 3 Epoch [ 24/100] Train Loss: 0.2280  Train Acc: 95.46%  |  Val Loss: 1.2120  Val BAcc: 84.32%  Val mAUC: 0.9558  LR: 0.001000  Time: 258.0s
Fold 3 Epoch [ 25/100] Train Loss: 0.1502  Train Acc: 96.66%  |  Val Loss: 1.2629  Val BAcc: 83.66%  Val mAUC: 0.9573  LR: 0.001000  Time: 266.8s
Fold 3 Epoch [ 26/100] Train Loss: 0.1828  Train Acc: 96.46%  |  Val Loss: 1.4658  Val BAcc: 83.79%  Val mAUC: 0.9456  LR: 0.001000  Time: 267.8s
Fold 3 Epoch [ 27/100] Train Loss: 0.1350  Train Acc: 96.63%  |  Val Loss: 1.2995  Val BAcc: 85.30%  Val mAUC: 0.9595  LR: 0.001000  Time: 265.9s
  -> New best balanced accuracy: 85.30%
Fold 3 Epoch [ 28/100] Train Loss: 0.1271  Train Acc: 97.19%  |  Val Loss: 1.6957  Val BAcc: 80.84%  Val mAUC: 0.9476  LR: 0.001000  Time: 255.6s
Fold 3 Epoch [ 29/100] Train Loss: 0.1210  Train Acc: 97.69%  |  Val Loss: 1.3546  Val BAcc: 83.87%  Val mAUC: 0.9589  LR: 0.001000  Time: 264.9s
Fold 3 Epoch [ 30/100] Train Loss: 0.0955  Train Acc: 97.72%  |  Val Loss: 1.3493  Val BAcc: 85.23%  Val mAUC: 0.9590  LR: 0.000100  Time: 265.0s
Fold 3 Epoch [ 31/100] Train Loss: 0.0558  Train Acc: 98.72%  |  Val Loss: 1.4043  Val BAcc: 85.15%  Val mAUC: 0.9598  LR: 0.000100  Time: 259.5s

Early stopping at epoch 31 (patience=20)

============================================================
  Fold 3 Best Val Results
============================================================
  Loss:              1.2995
  Accuracy:          85.95%
  Balanced Accuracy: 85.30%
  Micro AUC:         0.9611
  Macro AUC:         0.9595
  AUC (CN):         0.9850
  AUC (MCI):         0.9263
  AUC (AD):         0.9673

  Confusion Matrix:
               CN    MCI     AD
        CN    317     28      0
       MCI     19    252     23
        AD      1     55    202

  Per-class metrics:
    CN: Sensitivity=0.9188  Specificity=0.9638
    MCI: Sensitivity=0.8571  Specificity=0.8624
    AD: Sensitivity=0.7829  Specificity=0.9640
============================================================

  Confusion matrix saved to ./checkpoints/divnet/figures/fold_3_confusion_matrix.png
